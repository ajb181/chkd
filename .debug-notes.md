## Debug Session: 2026-01-20 21:34
**Bug:** Awaiting user clarification

### Findings
- `chkd fix` command already existed in CLI (line 239-280)
- API endpoint PATCH /api/bugs already existed  
- Database functions getBugByQuery/updateBugStatus already existed
- Command was just missing from user awareness

### Verified
- [x] `chkd fix "Test bug"` - worked
- [x] `chkd fix "Phase emoji"` - worked
- [x] `chkd bugs --all` shows both as fixed

No code changes needed - feature was already implemented.

## Debug Session: 2026-01-21 18:13
**Bug:** Terminal not connecting + sizing issues (horizontal/vertical scrollbars appearing)

### Symptoms
1. Terminal shows "Disconnected" and "Connecting to terminal..." forever
2. Small horizontal and vertical scrollbars appearing in terminal panel
3. Text "Connecting to terminal" also appears at bottom of screen (cropped/leaked)

### Research

### Findings
**Connection Issue:**
- Server running `vite dev` directly (npm run dev:vite)
- Should run `node dev-server.js` (npm run dev) for WebSocket support
- FIX: Restart server with correct command

**Sizing Issue:**
- .terminal-body has padding: 8px reducing space
- xterm-viewport set to overflow-y: auto showing scrollbar
- xterm may be rendering slightly larger than container

### Fix Applied

- Fixed spawn-helper missing execute permission (chmod +x)
- Fixed double keypress by closing old connections to same session
- Added scroll handler to only capture scroll when focused/hovered

### Status
Connection bug FIXED - terminal connects now.
Sizing/overflow bug PARTIALLY FIXED - still some issues with tmux status bar.

### Verified
- [x] Terminal connects (shows "Connected")
- [x] spawn-helper permissions fixed
- [x] Double keypress fixed
- [ ] Overflow fully contained (tmux bar still leaks slightly)

### Final Fixes Applied
- spawn-helper chmod +x (node-pty permission issue)
- Close old connections to prevent double input
- Removed `contain: strict` CSS (was blocking input textarea)
- Enabled xterm-helper-textarea explicitly
- Added restart button to terminal
- tmux `set mouse on` for scroll support

### Verified Working
- [x] Terminal connects
- [x] Keyboard input works
- [x] Mouse scroll works
- [x] Restart button added

### Remaining Minor Issues
- Text rendering occasionally incomplete
- Tmux status bar overflow (cosmetic)

## Status: FIXED (core functionality working, cosmetic overflow deferred)

---

## Session Closed: 2026-01-21
User decided to move on. Terminal is functional - connection, input, and scroll all work. Cosmetic overflow issue remains but not blocking.
## Debug Session: 2026-01-22 11:27
**Bug:** chkd CLI fails with 'Cannot find module /Users/alex/chkd-v2/src/cli/index.ts'

### Research
- Shell alias is the problem!
- `type chkd` shows: `chkd is aliased to 'npx tsx /Users/alex/chkd-v2/src/cli/index.ts'`
- Alias takes precedence over scripts in PATH
- Need to find and remove/update this alias in shell config

### Findings
The bug is NOT in tsx, npm link, or node caches.
It's a simple shell alias in the user's shell config that points to the old path.

### Fix Required
User needs to remove or update the alias in their shell config.

### Root Cause
Shell alias `alias chkd="npx tsx /Users/alex/chkd-v2/src/cli/index.ts"` was previously in ~/.zshrc and ~/.bashrc.
A previous Claude session already removed it from the files, but the current shell session still has it loaded.

### Fix Applied
The files are already fixed. User needs to either:
1. Restart terminal (to reload shell config)
2. Run `unalias chkd` in current session

### Verified
The underlying scripts work correctly when the alias is bypassed:
- `/Users/alex/bin/chkd status` works
- `bash /Users/alex/bin/chkd status` works
## Investigation: 23:14
**Bugs:** Worker system - missing files + FK constraint

### Bug 1: Workers missing CLAUDE.md/docs
- **Location:** src/lib/server/git/worktree.ts createWorktree()
- **Cause:** Only runs 'git worktree add' - doesn't copy untracked files
- **Fix:** After worktree creation, copy CLAUDE.md, docs/, .claude/

### Bug 2: stop_worker FK constraint error
- **Location:** src/lib/server/db/index.ts line 248
- **Cause:** manager_signals.worker_id has FK to workers(id)
- **Cause:** Signals created on spawn reference workerId
- **Fix:** Delete/nullify signals before deleting worker
